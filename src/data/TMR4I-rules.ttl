@prefix rule: <tag:stardog:api:rule:> .

## Inference rule to generate interaction instances

[]	a	rule:SPARQLRule;
	rule:content	"""
        PREFIX tmr4i: <http://guidelines.data2semantics.org/vocab/>
        PREFIX owl: <http://www.w3.org/2002/07/owl#>
        
        IF
        { 
             ?r1  a  tmr4i:Recommendation .
             ?r1  a  owl:NamedIndividual .
             ?r2  a  tmr4i:Recommendation .
             ?r2  a  owl:NamedIndividual .
             ?r1  tmr4i:partOf  ?g .
             ?r2  tmr4i:partOf  ?g .
             ?g  a  owl:NamedIndividual .
             ?r1  tmr4i:recommends ?t1 .
             ?r2  tmr4i:recommends ?t2 .
             ?t1 a owl:NamedIndividual .
             ?t2 a owl:NamedIndividual .
 
             { 
                 ?t1    tmr4i:similarToTransition ?t2 .
             }
             UNION
             {
                 ?t1    tmr4i:inverseToTransition ?t2 .
             }
             UNION
             {
                 ?ca    a tmr4i:CareActionType .
                 ?ca    a owl:NamedIndividual .
                 ?t1    tmr4i:promotedBy ?ca .
                 ?t2    tmr4i:promotedBy ?ca .
             }
             FILTER (?r1 != ?r2 && ?t1 != ?t2)
        } THEN {
            _:iir   a  tmr4i:InternalRecommendationInteraction, owl:NamedIndividual .
            _:iir  tmr4i:relates ?r1 .
            _:iir  tmr4i:relates ?r2 .
            ?r1 tmr4i:interactsInternallyWith ?r2 .
            ?r2 tmr4i:interactsInternallyWith ?r1 .
            tmr4i:interactsInternallyWith a owl:ObjectProperty . 
        }""" .


## Rules from the paper, converted from SWRL
## Added owl:NamedIndividual class membership for all instances to facilitate inferencing in Stardog.

# Rule 1
[]	a	rule:SPARQLRule;
	rule:content	"""
        PREFIX tmr4i: <http://guidelines.data2semantics.org/vocab/>
        PREFIX owl: <http://www.w3.org/2002/07/owl#>
        IF { 
            ?ca1	a	tmr4i:CareActionType, owl:NamedIndividual .
            ?ca2	a	tmr4i:CareActionType, owl:NamedIndividual .
            ?sa	a	tmr4i:SituationType, owl:NamedIndividual .
            ?sb	a	tmr4i:SituationType, owl:NamedIndividual .
            ?t1	a	tmr4i:Transition, owl:NamedIndividual .
            ?t2	a	tmr4i:Transition, owl:NamedIndividual .
            ?t1	tmr4i:hasExpectedPostSituation	 ?sb .
            ?t2	tmr4i:hasExpectedPostSituation	 ?sb .
            ?t1	tmr4i:hasTransformableSituation	 ?sa .
            ?t2	tmr4i:hasTransformableSituation	 ?sa .
            ?t1	tmr4i:promotedBy	?ca1 .
            ?t2	tmr4i:promotedBy	?ca2 .
            ?ca1 a  owl:NamedIndividual .
            ?ca2 a  owl:NamedIndividual .
            ?ca1	owl:differentFrom	?ca2 .
        } THEN { 
            ?t1	tmr4i:similarToTransition	 ?t2 .
        }""".

# Rule 2
[]	a	rule:SPARQLRule;
	rule:content	"""
        PREFIX tmr4i: <http://guidelines.data2semantics.org/vocab/>
        PREFIX owl: <http://www.w3.org/2002/07/owl#>
        IF { 
            ?sa	a	tmr4i:SituationType, owl:NamedIndividual .
            ?sb	a	tmr4i:SituationType, owl:NamedIndividual .
            ?t1	a	tmr4i:Transition, owl:NamedIndividual .
            ?t2	a	tmr4i:Transition, owl:NamedIndividual .
            ?t1	tmr4i:hasExpectedPostSituation	 ?sb .
            ?t2	tmr4i:hasExpectedPostSituation	 ?sa .
            ?t1	tmr4i:hasTransformableSituation	 ?sa .
            ?t2	tmr4i:hasTransformableSituation	 ?sb .
        } THEN { 
            ?t1	tmr4i:inverseToTransition	 ?t2 .
        }""".

# Rule 3
[]	a	rule:SPARQLRule;
	rule:content	"""
        PREFIX tmr4i: <http://guidelines.data2semantics.org/vocab/>
        PREFIX owl: <http://www.w3.org/2002/07/owl#>
        IF { 
            ?ca	a	tmr4i:CareActionType, owl:NamedIndividual .
            ?i	a	tmr4i:InternalRecommendationInteraction, owl:NamedIndividual .
            ?r1	a	tmr4i:Recommendation, owl:NamedIndividual .
            ?r2	a	tmr4i:Recommendation, owl:NamedIndividual .
            ?t1	tmr4i:promotedBy	 ?ca .
            ?t2	tmr4i:promotedBy	 ?ca .
            ?t1 a  owl:NamedIndividual .
            ?t2 a  owl:NamedIndividual .
            ?r2	tmr4i:recommendsToAvoid	 ?t2 .
            ?r1	tmr4i:recommendsToPursue	 ?t1 .
            ?i	tmr4i:relates	 ?r1 .
            ?i	tmr4i:relates	 ?r2 .
        } THEN { 
            ?i	a	tmr4i:ContradictionDueToSameAction, owl:NamedIndividual .
        }""".

# Rule 4
[]	a	rule:SPARQLRule;
	rule:content	"""
        PREFIX tmr4i: <http://guidelines.data2semantics.org/vocab/>
        PREFIX owl: <http://www.w3.org/2002/07/owl#>
        IF { 
            ?i	a	tmr4i:InternalRecommendationInteraction, owl:NamedIndividual .
            ?r1	a	tmr4i:Recommendation, owl:NamedIndividual .
            ?r2	a	tmr4i:Recommendation, owl:NamedIndividual .
            ?t1	tmr4i:inverseToTransition	 ?t2 .
            ?r1	tmr4i:recommendsToPursue	 ?t1 .
            ?r2	tmr4i:recommendsToPursue	 ?t2 .
            ?t1 a  owl:NamedIndividual .
            ?t2 a  owl:NamedIndividual .
            ?i	tmr4i:relates	 ?r1 .
            ?i	tmr4i:relates	 ?r2 .
        } THEN { 
            ?i	a	tmr4i:ContradictionDueToInverseTransition, owl:NamedIndividual .
        }""".

# Rule 5
[]	a	rule:SPARQLRule;
	rule:content	"""
        PREFIX tmr4i: <http://guidelines.data2semantics.org/vocab/>
        PREFIX owl: <http://www.w3.org/2002/07/owl#>
        IF { 
            ?i	a	tmr4i:InternalRecommendationInteraction, owl:NamedIndividual .
            ?r1	a	tmr4i:Recommendation, owl:NamedIndividual .
            ?r2	a	tmr4i:Recommendation, owl:NamedIndividual .
            ?r2	tmr4i:recommendsToAvoid	 ?t2 .
            ?r1	tmr4i:recommendsToPursue	 ?t1 .
            ?t1 a  owl:NamedIndividual .
            ?t2 a  owl:NamedIndividual .
            ?i	tmr4i:relates	 ?r1 .
            ?i	tmr4i:relates	 ?r2 .
            ?t1	tmr4i:similarToTransition	 ?t2 .
        } THEN { 
            ?i	a	tmr4i:ContradictionDueToSimiliarTransition, owl:NamedIndividual .
        }""".

# Rule 6
[]	a	rule:SPARQLRule;
	rule:content	"""
        PREFIX tmr4i: <http://guidelines.data2semantics.org/vocab/>
        PREFIX owl: <http://www.w3.org/2002/07/owl#>
        IF { 
            ?ca	a	tmr4i:CareActionType, owl:NamedIndividual .
            ?i	a	tmr4i:InternalRecommendationInteraction, owl:NamedIndividual .
            ?r1	a	tmr4i:Recommendation, owl:NamedIndividual .
            ?r2	a	tmr4i:Recommendation, owl:NamedIndividual .
            ?t1	tmr4i:promotedBy	 ?ca .
            ?t2	tmr4i:promotedBy	 ?ca .
            ?t1 a  owl:NamedIndividual .
            ?t2 a  owl:NamedIndividual .
            ?r1	tmr4i:recommendsToPursue	 ?t1 .
            ?r2	tmr4i:recommendsToPursue	 ?t2 .
            ?i	tmr4i:relates	 ?r1 .
            ?i	tmr4i:relates	 ?r2 .
            ?t1	owl:differentFrom	?t2 .
        } THEN { 
            ?i	a	tmr4i:RepetitionDueToSameAction, owl:NamedIndividual .
        }""".

# Rule 7
[]	a	rule:SPARQLRule;
	rule:content	"""
        PREFIX tmr4i: <http://guidelines.data2semantics.org/vocab/>
        PREFIX owl: <http://www.w3.org/2002/07/owl#>
        IF { 
            ?g	a	tmr4i:Guideline, owl:NamedIndividual .
            ?r1	a	tmr4i:Recommendation, owl:NamedIndividual .
            ?r2	a	tmr4i:Recommendation, owl:NamedIndividual .
            ?r3	a	tmr4i:Recommendation, owl:NamedIndividual .
            ?i1	a	tmr4i:RepetitionDueToSameAction, owl:NamedIndividual .
            ?i2	a	tmr4i:RepetitionDueToSameAction, owl:NamedIndividual .
            ?r1	tmr4i:partOf	 ?g .
            ?r2	tmr4i:partOf	 ?g .
            ?r3	tmr4i:partOf	 ?g .
            ?i1	tmr4i:relates	 ?r1 .
            ?i1	tmr4i:relates	 ?r2 .
            ?i2	tmr4i:relates	 ?r2 .
            ?i2	tmr4i:relates	 ?r3 .
            ?r1	owl:differentFrom	?r3 .
        } THEN {  
            ?i1	owl:sameAs	?i2 .
        }""".

# Rule 8
[]	a	rule:SPARQLRule;
	rule:content	"""
        PREFIX tmr4i: <http://guidelines.data2semantics.org/vocab/>
        PREFIX owl: <http://www.w3.org/2002/07/owl#>
        IF { 
            ?i	a	tmr4i:InternalRecommendationInteraction, owl:NamedIndividual .
            ?r1	a	tmr4i:Recommendation, owl:NamedIndividual .
            ?r2	a	tmr4i:Recommendation, owl:NamedIndividual .
            ?t1	tmr4i:inverseToTransition	 ?t2 .
            ?r2	tmr4i:recommendsToAvoid	 ?t2 .
            ?r1	tmr4i:recommendsToPursue	 ?t1 .
            ?t1 a  owl:NamedIndividual .
            ?t2 a  owl:NamedIndividual .
            ?i	tmr4i:relates	 ?r1 .
            ?i	tmr4i:relates	 ?r2 .
        } THEN { 
            ?i	a	tmr4i:AlternativeDueToInverseTransition, owl:NamedIndividual .
        }""".

# Rule 9
[]	a	rule:SPARQLRule;
	rule:content	"""
        PREFIX tmr4i: <http://guidelines.data2semantics.org/vocab/>
        PREFIX owl: <http://www.w3.org/2002/07/owl#>
        IF { 
            ?i1	a	tmr4i:AlternativeDueToSimilarTransition, owl:NamedIndividual .
            ?i2	a	tmr4i:AlternativeDueToSimilarTransition, owl:NamedIndividual .
            ?g	a	tmr4i:Guideline, owl:NamedIndividual .
            ?r1	a	tmr4i:Recommendation, owl:NamedIndividual .
            ?r2	a	tmr4i:Recommendation, owl:NamedIndividual .
            ?r3	a	tmr4i:Recommendation, owl:NamedIndividual .
            ?r1	tmr4i:partOf	 ?g .
            ?r2	tmr4i:partOf	 ?g .
            ?r3	tmr4i:partOf	 ?g .
            ?i1	tmr4i:relates	 ?r1 .
            ?i1	tmr4i:relates	 ?r2 .
            ?i2	tmr4i:relates	 ?r2 .
            ?i2	tmr4i:relates	 ?r3 .
            ?r1	owl:differentFrom	?r3 .
        } THEN {  
            ?i1	owl:sameAs	?i2 .
        }""".

# Rule 10
[]	a	rule:SPARQLRule;
	rule:content	"""
        PREFIX tmr4i: <http://guidelines.data2semantics.org/vocab/>
        PREFIX owl: <http://www.w3.org/2002/07/owl#>
        IF { 
            ?i	a	tmr4i:InternalRecommendationInteraction, owl:NamedIndividual .
            ?r1	a	tmr4i:Recommendation, owl:NamedIndividual .
            ?r2	a	tmr4i:Recommendation, owl:NamedIndividual .
            ?r1	tmr4i:recommendsToPursue	 ?t1 .
            ?r2	tmr4i:recommendsToPursue	 ?t2 .
            ?t1 a  owl:NamedIndividual .
            ?t2 a  owl:NamedIndividual .
            ?i	tmr4i:relates	 ?r1 .
            ?i	tmr4i:relates	 ?r2 .
            ?t1	tmr4i:similarToTransition	 ?t2 .
        } THEN { 
            ?i	a	tmr4i:AlternativeDueToSimilarTransition, owl:NamedIndividual .
        }""".

# Rule 11
[]	a	rule:SPARQLRule;
	rule:content	"""
        PREFIX tmr4i: <http://guidelines.data2semantics.org/vocab/>
        PREFIX owl: <http://www.w3.org/2002/07/owl#>
        IF { 
            ?ca	a	tmr4i:CareActionType, owl:NamedIndividual .
            ?sa	a	tmr4i:SituationType, owl:NamedIndividual .
            ?sb	a	tmr4i:SituationType, owl:NamedIndividual .
            ?t1	a	tmr4i:Transition, owl:NamedIndividual .
            ?t2	a	tmr4i:Transition, owl:NamedIndividual .
            ?t1	tmr4i:hasExpectedPostSituation	 ?sb .
            ?t2	tmr4i:hasExpectedPostSituation	 ?sa .
            ?t1	tmr4i:hasTransformableSituation	 ?sa .
            ?t2	tmr4i:hasTransformableSituation	 ?sb .
            ?t1	tmr4i:promotedBy	 ?ca .
            ?t2	tmr4i:promotedBy	 ?ca .
        } THEN {  
            ?t1	owl:sameAs	?t2 .
        }""".